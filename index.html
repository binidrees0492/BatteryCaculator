<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Battery Backup Calculator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- PWA Support -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#2563eb">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="icon" href="icons/icon-192.png" type="image/png">
</head>

<body class="bg-gradient-to-br from-blue-100 to-teal-100 min-h-screen flex flex-col">

  <!-- Header -->
  <header class="bg-blue-700 text-white p-4 shadow-md sticky top-0 z-10">
    <h1 class="text-xl font-bold text-center">ğŸ”‹ Battery Inverter Backup Time</h1>
    <p class="text-sm text-center text-blue-100">Accurate estimate based on real conditions</p>
  </header>

  <!-- Content -->
  <main class="flex-grow p-4">
    <div class="max-w-3xl mx-auto bg-white rounded-xl shadow-lg p-6 space-y-6">

      <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
        <div>
          <label class="block font-semibold text-gray-700 mb-1">ğŸ”Œ Battery Voltage (V)</label>
          <input type="number" id="voltage" class="input" value="12" placeholder="e.g. 12">
        </div>
        <div>
          <label class="block font-semibold text-gray-700 mb-1">ğŸ”‹ Battery Capacity (Ah)</label>
          <input type="number" id="capacity" class="input" value="200" placeholder="e.g. 200">
        </div>
        <div>
          <label class="block font-semibold text-gray-700 mb-1">ğŸ”¢ Number of Batteries</label>
          <input type="number" id="batteryCount" class="input" value="4" placeholder="e.g. 4">
        </div>
        <div>
          <label class="block font-semibold text-gray-700 mb-1">ğŸ’¡ Load Power (Watts)</label>
          <input type="number" id="loadWatt" class="input" value="1000" placeholder="e.g. 1000">
        </div>
        <div>
          <label class="block font-semibold text-gray-700 mb-1">âš™ï¸ Depth of Discharge (%)</label>
          <input type="number" id="dod" class="input" value="70">
        </div>
        <div>
          <label class="block font-semibold text-gray-700 mb-1">âš¡ Inverter Efficiency (%)</label>
          <input type="number" id="efficiency" class="input" value="90">
        </div>
        <div>
          <label class="block font-semibold text-gray-700 mb-1">ğŸ“‰ Battery Age Factor (%)</label>
          <input type="number" id="ageFactor" class="input" value="90">
        </div>
        <div>
          <label class="block font-semibold text-gray-700 mb-1">ğŸŒ¡ï¸ Temp Derating (%)</label>
          <input type="number" id="tempDerate" class="input" value="95">
        </div>
        <div>
          <label class="block font-semibold text-gray-700 mb-1">ğŸ”Œ Cable Losses (%)</label>
          <input type="number" id="cableLoss" class="input" value="98">
        </div>
        <div>
          <label class="block font-semibold text-gray-700 mb-1">ğŸ§ª Battery Health (%)</label>
          <input type="number" id="batteryHealth" class="input" value="100">
        </div>
      </div>

      <!-- Button -->
      <div class="text-center">
        <button onclick="calculateBackup()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold text-lg px-6 py-3 rounded-full w-full shadow-md">
          ğŸ§® Calculate Backup Time
        </button>
      </div>

      <!-- Result Box -->
      <div id="result" class="bg-green-50 border border-green-400 rounded-lg p-4 text-green-800 font-medium whitespace-pre-line text-sm sm:text-base hidden"></div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="text-center text-xs text-gray-500 p-3">
    &copy; 2025 Battery Tools App â€“ PWA Ready
  </footer>

  <!-- Script -->
  <script>
    function calculateBackup() {
      const voltage = parseFloat(document.getElementById("voltage").value);
      const capacity = parseFloat(document.getElementById("capacity").value);
      const batteryCount = parseFloat(document.getElementById("batteryCount").value);
      const loadWatt = parseFloat(document.getElementById("loadWatt").value);
      const dod = parseFloat(document.getElementById("dod").value);
      const efficiency = parseFloat(document.getElementById("efficiency").value);
      const ageFactor = parseFloat(document.getElementById("ageFactor").value);
      const tempDerate = parseFloat(document.getElementById("tempDerate").value);
      const cableLoss = parseFloat(document.getElementById("cableLoss").value);
      const batteryHealth = parseFloat(document.getElementById("batteryHealth").value);
      const output = document.getElementById("result");

      if (!voltage || !capacity || !batteryCount || !loadWatt) {
        output.classList.remove("hidden");
        output.innerText = "âš ï¸ Please fill all required fields.";
        return;
      }

      const rawWh = voltage * capacity * batteryCount;
      const usableWh = rawWh *
        (dod / 100) *
        (efficiency / 100) *
        (ageFactor / 100) *
        (tempDerate / 100) *
        (cableLoss / 100) *
        (batteryHealth / 100);

      const hours = usableWh / loadWatt;
      const h = Math.floor(hours);
      const m = Math.round((hours - h) * 60);

      output.classList.remove("hidden");
      output.innerText =
        `ğŸ”‹ Total Battery Energy: ${rawWh} Wh\n` +
        `âš¡ Usable Energy (adjusted): ${usableWh.toFixed(2)} Wh\n` +
        `â±ï¸ Estimated Backup Time: ${h} hour(s) ${m} minute(s)\n\n` +
        `ğŸ“‹ Factors Applied:\n` +
        `â€¢ DoD: ${dod}%\nâ€¢ Inverter Eff: ${efficiency}%\nâ€¢ Age Factor: ${ageFactor}%\nâ€¢ Temp Derate: ${tempDerate}%\nâ€¢ Cable Loss: ${cableLoss}%\nâ€¢ Health: ${batteryHealth}%`;
    }

    // Apply Tailwind input styles dynamically
    document.querySelectorAll('.input').forEach(input => {
      input.classList.add(
        'border', 'rounded-lg', 'p-3', 'w-full',
        'bg-gray-50', 'focus:outline-none', 'focus:ring-2', 'focus:ring-blue-400',
        'text-sm', 'text-gray-800'
      );
    });
  </script>
</body>
</html>
